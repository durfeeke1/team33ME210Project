<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Team 33 Report</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/grayscale.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
    <nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                    <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand page-scroll" href="#page-top">
                    <i class="fa fa-play-circle"></i>  <span class="light">Team 33</span> Report
                </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#about">Overview</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#download">Systems</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">Reflections</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Intro Header -->
    <header class="intro">
        <div class="intro-body">
            <div class="container">
                <div class="row">
                    <div class="col-md-8 col-md-offset-2">
                        <h1 class="brand-heading">TEAM 33<h1>
                        <p class="intro-text">Team Name: 0 - 2 (Real Quick)<br>ME210 Winter</p>
                        <a href="#about" class="btn btn-circle page-scroll">
                            <i class="fa fa-angle-double-down animated"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- About Section -->
    <section id="about" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Project Overview</h2>
                <img src="img/teamPhoto.jpg"><img>
                <p>Team Members: Kevin Durfee, Carey Smith, Ryan Wolff, Maria Malone</p>
                
                <p> As the ME 210 Robot Project sat on our Winter Quarter horizon, Team 0 to 2 (Real Quick) pondered our overall strategy. While we wanted to put 100% effort into the project, we also valued our health and other classes. We deemed ourselves to be a “Shallow Grave” group – we wanted to do enough work to check off and learn a lot, but weren’t preparing ourselves to win the competition. </p>
                <p> When the project was assigned we decided early on that we would not do beacon sensing, and instead we chose to use the tape on the board to align ourselves with the 1 point basket on our side of the court. </p>
            
            	<p> Here is our story. </p>
            </div>
        </div>
    </section>

    <!-- Systems Section -->
    <section id="download" class="content-section text-center">
        <div class="download-section">
            <div class="container">
<!--                 Sub system overview -->
                <div class="col-lg-8 col-lg-offset-2">
                    <h2>DrizzyBot / Cheff Curry - Sub Systems</h2>
                    <h3> Bill Of Materials </h3>
                    <!-- 
<p>Arduino Uno: 1, Jameco 162191 Motor: 2, BaneBots Wheel 2-7/8"x0.8" 1/2" HexMount: 2,
BaneBots Hub 12" Hex, series 40 w/ 4mm Bore: 2, HS-322HD Servo motor 1, L293 Driver PCB Rev 3: 1, 5V Regulator: 1, 12V Regulator: 1, LM339N Op-Amp: 1, LM324N Comparator: 1, Switches: 2, 5mm LED: 3, 1 Amp Fuse: 1, 5 Amp Fuse: 1, Threaded rod 5/16" 1': 4, L brackets: 4, Clear Acrylic 1/4" 1'x1': 1, Duron 1/8" 2'x4': 2,
Caster wheel: 1, Bearing: 1
</p>
 -->
<img src="img/BOM2.png"></img>
                   <br/>
                   <br/>
                </div>
            </div>
            
            <div class="container">
<!--                 Mechanical Design -->
                <div class="col-lg-8 col-lg-offset-2">
                    <h2>Mechanical Design</h2>
                    <h3>Overall Chassis Design</h3>
                    
                    <p>We chose a body shape that we thought would be ideal to keep us out of corners yet still align us square on the wall behind us. However the radius of the nose of the body did render us useless in some corners when starting from certain positions on the court. A square bot, though, would not have kept us from getting stuck in corners either. Overall bot design could have been improved with a circular bot base. Implementing alignment bumpers similar to the ones currently on Drizzy Bot/Chef Curry would have still allowed a circular design to accurately line and square up on the wall.   </p>
                    <img src="img/cadSideView.png"><img>
                    <p> </p>
                    
                    
                    <h3>Drive Train</h3>
                    
                    <p>The secure mounting of our motor to both the body of the bot and the wheels was crucial in order to get a reliable driving bot that wasn’t unstable or weak. Initially, we used two similar motor mounts on each side, each of which cradled the motor to keep it from falling. These two mounts were then fixed a distance apart using bolts and nuts. However, because it was difficult to get the precise tolerance in the motor mounts, there was just enough “slop” and freedom for the motors to move and shift within the mount. We then decided it would be best to create just one motor mount for each side, which bolted into the face of the motor and was then secured to the base of the bot through an L-bracket. This was a reliable method for motor stabilization, albeit not the most intricate or aesthetically pleasing. However, because it was a method that worked well, we decided to move forward with the construction of the rest of our bot. </p>
                    <img src="img/cadBase.png"><img>
                    
                    <p> </p>
                    
                    <h3>Tape Sensors</h3>
                    
                    <p> The mechanical design of our tape sensor setup was crucial to the successful functioning of the system as a whole. If the spacing of the sensors was slightly off, the accuracy of both tape sensing and following would be lower than it potentially could be. When using tape sensors, the spacing is crucial but so is the position of the tape sensors relative to the board. Because the tape sensors easily could pick up ambient light, the ideal height of the tip of the sensors was 1mm-4mm above the board. Additionally, the tip of the sensors needed to be as parallel to the board as possible. Because different times of day and conditions could easily affect the reading of the tape sensors, we wanted to have the freedom and ability to adjust the positioning of each tape sensor and the sensor platform as a whole. Therefore each sensor was mounted to its own individual backplate, which itself was secured to the tape sensor platform. The screw which attached each tape sensor to the backplate allowed for individual tape sensor height adjustment fairly easily. (Each tape sensor has an optimally sized slot for a 4-40 screw to be used for mounting). The platform height was adjustable using a double nut design. If tape sensors are used, we highly suggest using some sort of adjustable design, similar to what we used. This allows for fine-tuning of the physical tape sensing system for optimal readings and response. </p>
                    <img src="img/cadTapeSide.png"><img>
                    <img src="img/cadTapeTop.png"><img>
                 	<p> </p>   
                 
                    <h3>Shooting Mechanism</h3>
                    
                    <p>Initially we couldn’t settle on an approach for scoring points. So we wavered between doing a shooter and dunker for a while. Because we lost a lot of time in limbo between the two, we decided that the most efficient use of our time was to implement a dunker in order check off. Our thoughts were to then perfect it when/if we had time. Because we worked to check off early, we used a dunk mechanism that ended up completing the challenge, yet was a visual eye sore. Our initial more intricate design implementing a natural hinge ended up being too heavy. While we liked the look and experiment with design much more, we knew that a more simple and light solution was needed to not overstress our servo motor. </p>
                    <img src="img/cadTopLayer.png"><img>
                    <p> </p>
                    
                </div>
            </div>
            
            <div class="container">
<!--                 Electrical Design -->
                <div class="col-lg-8 col-lg-offset-2">
                    <h2>Electrical Design</h2>
                    <p>We broke the electrical system down into a few different circuits that were linked together. 
                    <br/>
                    <strong>Power Supply, Drive Train, Tape sensing, shooter mechanism</strong>
                    <br/>
                    <br/>
                    Generally our circuits were pretty solid. The biggest issue we encountered was when we swapped chasis. We had used the double sided tape on the bread boards to fix them to the first bot. When we removed them the tape completely destroyed our circuits!!! DON'T DO THAT.                     
                </p>
                  	<img src="img/circuits.jpg"></img>
                  	<p>a photo of our circuits on the bot</p>
                  	
                  	<h3>Schematics</h3>
                  	<img src="img/drivetrainSch.png"></img>
                  	<p>drivetrain schematic<p/>
                  	<br/>
                  	<br/>
                  	<img src="img/powerSch.png"></img>
                  	<p>power supply schematic<p/>
                  	<h2>Tape Sensing</h2>
                  	<p>In our original design we attempted to create a digital input to the Arduino from each tape sensor.  This design had three 
                  	components to it.
                  	</p>
                  	<p>
                  	First, we tied the anode of the photodiode to 5V and placed an 130 ohm resistor between its cathode and ground.
                  	This was done to ensure that the current going through the photodiode was large enough to be detected by the phototransistor
                  	but also not large enough to damage the component.  
                  	</p>
                  	<p>
                  	Equation 1: (Vdd-Vf)< 40ma => (5V-0V)/40ma < R => R > 125 ohms
                  	</p>
                  	<p>
                  	Equation 2: (Vdd-Vf)> 20ma => (5V-1.7V)/20ma > R => R < 165 ohms
                  	</p>
                  	<p>
                  	Second, we used an op-amp to amplify the signal.  Here the positive input of the op-amp is tied to another op-amp that is generating
                  	a stable 2.5V.  Using our ideal op-amp model this means that the op-amp will work as hard as it can to keep the negative input at
                  	2.5V.  As a result there is always a (5V-2.5V) = 2.5V drop across the phototransistor, which satisfies the forward voltage drop required 
                  	for it to function properly.  Since the current from the phototransistor cannot pass through the op-amp it can only travel through
                  	the resistor that connects the output to the negative input.  As a result there is a voltage drop from the negative input to the output
                  	that is equal to the current from the photodiode multiplied by the resistor.  Therefore our equation describing the output voltage
                  	as a function of the photodiode current is as follows:
                  	</p>
                  	<p>
                  	Equation 3: Vo - V- = -IR => Vo = V- -IR => Vo = 2.5V - IR
                  	</p>
                  	<p>
                  	We saw the voltage range from 2-2.5 when the tape sensor was about a quarter inch from the tape to .5 when the tape sensor was a quarter
                  	inch from the white board.  We also tied an LED to the output of this stage, to give us visual confirmation that the circuit was generating
                  	the expected result.  We used similar calculations to the ones used in stage 1 to determine that a 75 ohm resistor was required to limit
                  	the current through the diode.  THIS WAS EXTREMELY HELPFUL! If you can use LED's to indicate what is happening in your circuits it makes it
                  	much easier to figure out what is going wrong while you are debugging.
                  	</p>
                  	<p>
                  	The final stage of the circuit was meant to convert the signal from the op-amp to a logical 1 or 0 for the Arduino using a comparator
                  	with hysteresis.  We eventually ended up dropping this stage of the circuit in our final design and used analoge input pins to read
                  	the output signal from the op-amp stage directly.  This was done for a few reasons. First, the Arduino Uno only has 2 pins that can
                  	be configured to generate interrupts on rising or falling signals.  Since our design uses 3 tape sensors, we couldn't take advantage
                  	of the speedy response time that interrupts offer.  Second, the amount of ambient light in the lab changed the output of the op-amp stage
                  	enough that it was difficult to get the comparator stage to accurately determine if it should generate a 1 or 0.  This could have been
                  	avoided if we had used an oscillator to generate the signal from our photodiode and then filtered out any signal from ambient light.  In the
                  	end we decided the easiest thing to do would just be to handle the hysteresis and logic level conversion in software.  I would recommend this
                  	to anyone.  You only have two weeks and changing or debugging software is much easier than changing and debugging hardware.
                  	</p>
                  	<img src="img/firstTapeSensingCircuit.png"></img>
                  	<p>Original Tape Sensing Circuit Design<p/>
                  	<img src="img/finalTapeSensingCircuit.png"></img>
                  	<p>Final Tape Sensing Circuit Design<p/>
                </div>
            </div>
            
            <div class="container">
                <!--                 Software Design -->
                <div class="col-lg-8 col-lg-offset-2">
                    <h2>Software Design</h2>
                    <p>Our software design can be broken down into a two levels. The first is the global state machine and the second
                    is comprised of a mini state machine for each global state.  This design is helpful because it segments the mini state
                    machines from each other, making them easier to develop and debug independently.  It also made it easy to loop the global
                    state machine in order to make multiple passes at the hoop.
                    </p>
                    <p> <h3>Global State Machine</h3>
                    	<li>Get Balls - used to bump the edge of the board and wait for balls to be loaded</li>
                    	<li>Align To Drive Straight - used to position the robot to follow the left wall to the end of the board</li>
                    	<li>Drive Straight - used to send the robot to the end of the board</li>
                    	<li>Tape Sensing - used to find the tape in front of the hoop and make a 90 degree turn</li>
                    	<li>Dunking - used to raise the servo and drop the balls in the hoop</li>
                    </p>
                    <p><h3>Sub State Machines:</h3>
                    	<p>Each of the sub state machines was implemented as a single function with a static variable used to keep track of
                     	   the current state.  I would recommend this as it hides the sub state machines state from the rest of the code.  When
                     	   the sub state machine has accomplished it's task it then changed the global state to move on to the next sub state machine.
                     	</p>
                	</p>
                	</p>
                	</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>What we learned</h2>
                <p>We executed our plan but made changes along the way, the best practice we can recommend is to anticipate and prepare for unknown changes. The best way to do this is designing for testing. Build your components to be sturdy but flexible and provide feedback. 

The first mount for our tape sensors allowed us to adjust the distance between them. It was quick, flexible and we could immediately change the arrangement based on observations we wouldn’t have predicted.
				</p>
				<p>

Our tape sensors were arranged close together on the underside of the bot and very difficult to see which sensor was over tape at any time. We integrated LEDs into our tape sensing circuit that indicated when each tape sensor was reading Hi at any given moment. This helped in most cases but as we progressed our states were dependent the previous tape sensor reading as well as the most recent. To solve this issue, we arranged the arduino to allow for “tethered” testing. The serial monitor displayed which state our bot was in and anytime the sensors changed. With this information could determine the exact path the bot and sensors took over the tape and how to correct it. 

We designed and built many of the components in parallel but upon integration ran into multiple problems (Here’s a tip - using the Servo library disables the PWM functionality of pins 9 & 10, so don’t use them to run your motors). Swapping chassis also changed the weight distribution, negating the time spent calibrating the motors on the first version. 
				</p>
				<p>
The language and naming conventions should also be made clear early on. Things can get confusing when you start turning, moving in reverse, increase the power of the right motor to turn left, etc. Like in theatre, they have a convention of stage right/left, discuss the behavior of your bot in a consistent manner and comment your code accordingly.
				</p>
				<p>
Remember to step back and look at how everything works together. There are many solutions to every problem. If you are having trouble getting results with an electrical component like the tape sensors, think about a software or mechanical solution. You could change the hysteresis or change where they are mounted or you could change another part of the bot entirely. We modified the shape of our bot and used its geometry to orient ourselves perpendicular to the walls. This allowed for a consistent approach angle to the tape which was crucial for our alignment with the basket. Don’t underestimate the physical world! Cut out a model of your bot and walk it around the game board, walk it around, take it through your states step by step. 
                </p>
               
            </div>
        </div>
    </section>

    <!-- Map Section -->

    </footer>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="js/jquery.easing.min.js"></script>

    <!-- Google Maps API Key - Use your own API key to enable the map feature. More information on the Google Maps API can be found at https://developers.google.com/maps/ -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRngKslUGJTlibkQ3FkfTxj3Xss1UlZDA&sensor=false"></script>

    <!-- Custom Theme JavaScript -->
    <script src="js/grayscale.js"></script>

</body>

</html>
